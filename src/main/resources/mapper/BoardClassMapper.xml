<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
  <mapper namespace="mapper.BoardClassMapper">
  	<resultMap type="vo.BoardClass" id="boardClass">
  		<id column="cbno" property="cbno"/>
  		<result column="title" property="title"/>
  		<result column="content" property="content"/>
  		<result column="host" property="host"/>
  		<result column="view_count" property="viewCount"/>
  		<result column="regdate" property="regdate"/>
  		<result column="updatedate" property="updatedate"/>
  		<result column="end" property="end"/>
  		<result column="accept" property="accept"/>
  	</resultMap>
  	<select id="selectOne" resultMap="boardClass">
  		select * from tbl_board_class where cbno = #{cbno}
  	</select>
  	<select id="selectList" resultMap="boardClass">
  		select * from tbl_board_class
  	</select>
  	<select id="showList" resultMap="boardClass">
  		select tbc.* 
  		from tbl_board_class tbc
  		where accept = 1 
  		<if test="type != null">
	    	<trim prefix="and (" suffix=")" prefixOverrides="or">
				<foreach collection="typeArr" item="t">
					<if test='t == "T"'>
						or title like concat('%', #{keyword}, '%')
					</if>
					<if test='t == "C"'>
						or content like concat('%', #{keyword}, '%')
					</if>
					<if test='t == "W"'>
						or host like concat('%', #{keyword}, '%')
					</if>
				</foreach>    	
	    	</trim>
	    </if>
  		order by 1 desc
  	</select>
  	<select id="trendList" resultMap="boardClass">
  		select * 
		from tbl_board_class 
		where accept = 1 
		and end = 0 
		order by view_count desc 
		limit 3
  	</select>
  	<insert id="insert">
  		insert into tbl_board_class(title, content, host)
  		values (#{title}, #{content}, #{host})
  	</insert>
  	<update id="update">
  		update tbl_board_class set title= #{title}, content = #{content}, updatedate = now() where cbno = #{cbno}
  	</update>
  	<update id="increaseViewCount">
  		update tbl_board_class set view_count = view_count + 1 where cbno = #{cbno}
  	</update>
  	<delete id="delete">
  		delete from tbl_board_class where cbno = #{cbno}
  	</delete>
  </mapper>